# タスク: Step 14 オッズ異常検知（人気の盲点抽出）ロジックの実装

## 目的
[cite_start]定期取得しているオッズデータから、一般大衆のノイズから外れた「確信度の高い資金の流入」を論理的に炙り出す異常検知サービスを実装する [cite: 2]。

## 実行要件
1. **異常検知サービスの実装**:
   `OddsAnomalyDetector` クラスを新規作成し、Step 13の定期実行処理から最新のパース済みオッズデータリストを渡して呼び出す。

2. **ノイズの除外（フィルタリング）**:
   [cite_start]全体への影響が大きすぎるため、上位人気（単勝1〜3番人気）のオッズ変動は異常検知の判定対象から除外するロジックを組み込む [cite: 31]。

3. **検知ロジック A: 支持率の急増検知**:
   - 比較用の前回データ（または基準値）をインメモリ（`ConcurrentHashMap`等）で保持する。
   - [cite_start]オッズの変動率ではなく、単勝オッズの逆数である「支持率」を計算する [cite: 15]。
   - [cite_start]計算式: `(1 / 直近単勝オッズ) - (1 / 過去単勝オッズ)` [cite: 17]
   - [cite_start]判定条件: 対象馬（特に中穴5〜8番人気、大穴9〜12番人気帯）において、支持率が `+2.0%` （0.02）以上急増した場合にアラートとする [cite: 16, 18]。

4. **検知ロジック B: 単複オッズの順位乖離（歪み検知）**:
   - [cite_start]同一レース内で「単勝人気の順位」と「複勝（下限）の順位」を算出・比較する [cite: 20]。
   - [cite_start]計算式: `単勝人気の順位 - 複勝下限オッズの順位` [cite: 22]
   - [cite_start]判定条件: ギャップが `3` 以上（例：単勝10番人気に対し、複勝下限が7番人気相当）開いている馬を抽出する [cite: 23][cite_start]。馬券圏内の期待値が高いシグナルとして扱う [cite: 24]。

5. **検知結果のDTOとログ出力**:
   - フロントエンドへ渡すための `AnomalyAlertDto` (馬番、馬名、検知タイプ[支持率急増/順位乖離]、該当数値) を作成し、リストで最新状態を保持する。
   - 異常を検知した際は、コンソールに `INFO` レベルで詳細を出力する。